import{world,system,ItemStack,EnchantmentType}from"@minecraft/server";export const importantItems=new Set(["hfrlc:info_book","hfrlc:system_level","hfrlc:trinket_menu"]);function dropStolenItem(t){t.runCommand("replaceitem entity @s slot.weapon.mainhand 0 air");const e=t.getComponent("inventory");if(e&&e.container){const n=e.container.getItem(0);if(n)return t.dimension.spawnItem(n,t.location),e.container.setItem(0,void 0),!0}return!1}export function onDamage(t,e){if(!t||"hfrlc:rat"!==t.typeId||!e||"minecraft:player"!==e.typeId)return;const n=e.getComponent("equippable")?.getEquipmentSlot("Mainhand"),o=n?.getItem();if(!o||t.getProperty("hfrlc:equipped_item")||importantItems.has(o.typeId))return;const r=t.getComponent("inventory");if(r&&r.container){if(!r.container.addItem(o)){n.setItem(void 0),t.setProperty("hfrlc:equipped_item",!0);const e=o.amount??1,r=o.getComponent("durability")?.damage??0;t.runCommand(`replaceitem entity @s slot.weapon.mainhand 1 ${o.typeId} ${e} ${r}`)}}o.hasTag("minecraft:is_tool")||o.hasTag("minecraft:is_sword")||(t.setProperty("hfrlc:states","scape"),t.triggerEvent("hfrlc:run"))}export function onRatDeath(t){t&&"hfrlc:rat"===t.typeId&&(t.runCommand("replaceitem entity @s slot.weapon.mainhand 0 air"),system.runTimeout(()=>{const e=t.getComponent("inventory");if(e&&e.container){const n=e.container.getItem(0);n&&(t.dimension.spawnItem(n,t.location),e.container.setItem(0,void 0))}},1))}export function ratEvents(t,e){"hfrlc:rat"===t?.typeId&&"hfrlc:loot"===e&&dropStolenItem(t)}